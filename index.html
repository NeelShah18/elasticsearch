<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en">
<!--<![endif]-->

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">

    <title>Elastic-search tutorial for datascience lab | Documentation by Neel Shah</title>

    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/stroke.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="css/animate.css">
    <link rel="stylesheet" type="text/css" href="css/prettyPhoto.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">

    <link rel="stylesheet" type="text/css" href="js/syntax-highlighter/styles/shCore.css" media="all">
    <link rel="stylesheet" type="text/css" href="js/syntax-highlighter/styles/shThemeRDark.css" media="all">

    <!-- CUSTOM -->
    <link rel="stylesheet" type="text/css" href="css/custom.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

        <div class="container">

            <section id="top" class="section docs-heading">

                <div class="row">
                    <div class="col-md-12">
                        <div class="big-title text-center">
                            <h1>Elasticsearch datasciencelab wiki</h1>
                            <p class="lead">Documentation version v 1.0</p>
                        </div>
                        <!-- end title -->
                    </div>
                    <!-- end 12 -->
                </div>
                <!-- end row -->

                <hr>

            </section>
            <!-- end section -->

            <div class="row">

                <div class="col-md-3">
                    <nav class="docs-sidebar" data-spy="affix" data-offset-top="300" data-offset-bottom="200" role="navigation">
                        <ul class="nav">
                            <li><a href="#line1">Getting Started</a></li>
                            <li><a href="#line2">Run & Configure</a></li>
                            <li><a href="#line3">Query</a></li>
                            <li><a href="#line4">Multi-processing</a></li>
                            <li><a href="#line5">Server strucutre</a></li>
                            <li><a href="#line11">Copyright and license</a></li>
                        </ul>
                    </nav >
                </div>
                <div class="col-md-9">
                    <section class="welcome">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Introduction<hr></h2>
                                <div class="row">

                                    <div class="col-md-12 full">
                                        <div class="intro1">
                                            <ul>
                                                <li><strong>Author  : </strong> <a href=" https://neelshah18.github.io/" target="_blank">Neel Shah</a></li>
                                                <li><strong>Support Forum : </strong> <a href="https://github.com/NeelShah18/elasticsearch" target="_blank">https://github.com/NeelShah18/elasticsearch</a></li>
                                            </ul>
                                        </div>

                                        <hr>
                                        <div>
                                            <p>
                                                <strong>Elasticsearch</strong> is an Apache Lucene-based search server. It was developed by Shay Banon and published in 2010. It is now maintained by Elasticsearch BV. Its latest version is 2.1.0.

                                                <p>Elasticsearch is a real-time distributed and open source full-text search and analytics engine. It is accessible from RESTful web service interface and uses schema less JSON (JavaScript Object Notation) documents to store data. It is built on Java programming language, which enables Elasticsearch to run on different platforms. It enables users to explore very large amount of data at very high speed.
                                                </p>
                                            </p>
                                            <h4>Elasticsearch – General Features</h4>
                                            <p>The general features of Elasticsearch are as follows −</p>
                                            <ol>
                                                <li>Elasticsearch is scalable up to petabytes of structured and unstructured data.</li>
                                                <li>Elasticsearch can be used as a replacement of document stores like MongoDB and RavenDB.</li>
                                                <li>Elasticsearch uses denormalization to improve the search performance.</li>
                                                <li>Elasticsearch is one of the popular enterprise search engines, which is currently being used by many big organizations like Wikipedia, The Guardian, StackOverflow, GitHub etc.</li>
                                                <li>Elasticsearch is open source and available under the Apache license version 2.0.</li>

                                            </ol>

                                        </div>
                                    </div>

                                </div>
                                <!-- end row -->
                            </div>
                        </div>
                    </section>

                    <section id="line1" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Getting Started <a href="#top">#back to top</a><hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">
                            <div class="col-md-12">
                               <h4>Elasticsearch – Key Concepts</h4>
                               <p>The key concepts of Elasticsearch are as follows −</p>
                               <ol>
                                   <li>Node − It refers to a single running instance of Elasticsearch. Single physical and virtual server accommodates multiple nodes depending upon the capabilities of their physical resources like RAM, storage and processing power.</li>
                                   <li>Cluster − It is a collection of one or more nodes. Cluster provides collective indexing and search capabilities across all the nodes for entire data.</li>
                                   <li>Index − It is a collection of different type of documents and document properties. Index also uses the concept of shards to improve the performance. For example, a set of document contains data of a social networking application.</li>
                                   <li>Type/Mapping − It is a collection of documents sharing a set of common fields present in the same index. For example, an Index contains data of a social networking application, and then there can be a specific type for user profile data, another type for messaging data and another for comments data.</li>
                                   <li>Document − It is a collection of fields in a specific manner defined in JSON format. Every document belongs to a type and resides inside an index. Every document is associated with a unique identifier, called the UID.</li>
                                   <li>Shard − Indexes are horizontally subdivided into shards. This means each shard contains all the properties of document, but contains less number of JSON objects than index. The horizontal separation makes shard an independent node, which can be store in any node. Primary shard is the original horizontal part of an index and then these primary shards are replicated into replica shards.</li>
                                   <li>Replicas − Elasticsearch allows a user to create replicas of their indexes and shards. Replication not only helps in increasing the availability of data in case of failure, but also improves the performance of searching by carrying out a parallel search operation in these replicas.</li>
                                </ol>
                                <h4>Elasticsearch – Advantages</h4>
                                <ol>
                                    <li>Elasticsearch is developed on Java, which makes it compatible on almost every platform.</li>
                                    <li>Elasticsearch is real time, in other words after one second the added document is searchable in this engine.</li>
                                    <li>Elasticsearch is distributed, which makes it easy to scale and integrate in any big organization.</li>
                                    <li>Creating full backups are easy by using the concept of gateway, which is present in Elasticsearch.</li>
                                    <li>Handling multi-tenancy is very easy in Elasticsearch when compared to Apache Solr.</li>
                                    <li>Elasticsearch uses JSON objects as responses, which makes it possible to invoke the Elasticsearch server with a large number of different programming languages.</li>
                                    <li>Elasticsearch supports almost every document type except those that do not support text rendering.</li>
                                </ol>
                                <h4>Elasticsearch – Disadvantages</h4>
                                <ol>
                                    <li>Elasticsearch does not have multi-language support in terms of handling request and response data (only possible in JSON) unlike in Apache Solr, where it is possible in CSV, XML and JSON formats.</li>
                                    <li>Elasticsearch also have a problem of Split brain situations, but in rare cases.</li>
                                </ol>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                    </section>
                    <!-- end section -->

                    <section id="line2" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Run & Configure elasticsearch <a href="#top">#back to top</a><hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->
                        <hr>

                        <h4>Run steps:</h4>
                        <ol>
                            <li>Login to HPC using SSH tunnel(You need username and password created by HPC): <strong>ssh (username)@wesley.lakeheadu.ca</strong></li>
                            <li>All elasticsearch source code location- <strong>/home/(username)/data/elsrc/</strong></li>
                            <li>Load java using below command:<br /> <strong>module load java</strong><br />Load python using below command: <br /><strong>module load EMD</strong></li>
                            <li>To run elasticsearch go to elasticsearch source code than: <strong>(elasticsearch-sourcecode-loc)/bin/elasticsearch</strong></li>

                        </ol>
                        <h4>Upload data.</h4>
                        <ol>
                          <li>Open second terminal and keep first terminal running(otherwise elasticsearch process will end)</li>
                          <li>go to <strong>./local/bin</strong></li>
                          <li>No you can use our Multi-processing upload function: Please check Multi-processing section for more details.</li>
                        </ol>

                        <h4>Query</h4>
                        <ol>
                          <li>open new terminal from same node.</li>
                          <li>All Kibana source code location- <strong>/home/(username)/data/kibana/</strong></li>
                          <li>To run Kibana go to Kibana source code than: <strong>(kibana-sourcecode-loc)/bin/kibana</strong></li>
                          <li>Now Kibana is runing and keep that terminal open.</li>
                          <li>Copy the link in terminal and past it to your browzer. Now kibana is online.</li>
                          <li>Go to devtool section: here you can write query and you will get all your data in json file as return</li>
                        </ol>
                        <p><strong>If your data is too large use "curl" command to export data because browzer has limitation.</strong></p>
                    </section>
                    <!-- end section -->

                    <section id="line3" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Query  <a href="#top">#back to top</a><hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <h4>List of basic quries</h4>
                        <p>Create Index: In this section, we will add some index, mapping and data to Elasticsearch. This data will be used in the examples explained in this tutorial.</p>
                        <div class="intro2 clearfix">
                            <p>curl -XPUT http://localhost:9200/schools </p>
                        </div>
                        <p>Response: It can contain index specific settings, but for now, it is empty for default settings.</p>
                        <div class="intro2 clearfix">
                            <p>{"acknowledged": true}(This means index is created) </p>
                        </div>
                        <p>Create Mapping and Add data:Elasticsearch will auto-create the mapping according to the data provided in request body, we will use its bulk functionality to add more than one JSON object in this index.</p>
                        <div class="intro2 clearfix">
                            <p>curl -XPOST http://localhost:9200/schools/_bulk -d @(address-of-json-file)</p>
                        </div>
                        <p>To check all data from specific index: <strong>(All data will return in json fomrat)</strong></p>
                        <div class="intro2 clearfix">
                            <p>curl -XGET /_search{"query": {"match_all": {}}}</p>
                        </div>

                    </section>
                    <!-- end section -->

                    <section id="line4" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Multi-processing <a href="#top">#back to top</a><hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">
                                <p>We are using <strong>json-py-es</strong> for importing and validating JSON file. We can all the things together or deprately as per requirements.</p>
                                <img src="./images/lib1.png" width="100%" height="100%">Working strucutre</img>

                        </div>
                        <div class="row">
                          <h4>Intructions</h4>
                          <p>There are 3 proccesses of importing raw JSON data to ElasticSearch</p>
                          <ol>
                            <li>Only validating raw JSON data</li>
                            <li>Without validating ,just import data to ElasticSearch</li>
                            <li>After validating successfully, then import data to ElasticSearch</li>
                          </ol>
                          <p>A valid JSON file here refers to a JSON file stacked with many lines of data <br />file valid_data.json and its content <br />{"key1": "valueA", "key2": {"sub_key1": "value2A", "sub_key2": ["Good", "Morning"]}} <br />{"key1": "valueB", "key2": {"sub_key1": "value2B", "sub_key2": ["Good", "Afternoon"]}} <br />...<br />{"key1": "valueC", "key2": {"sub_key1": "value2C", "sub_key2": ["Good", "Evening"]}}</p>
                        <h4>Functions included</h4>
                        <p>1. Validating JSON format data</p>
                        <div class="intro2 clearfix">
                            <p>jsonpyes --data raw_data.json --check</p>
                        </div>
                        <p>If the json data file is valid:<br />json valid</p>
                        <p>If the json data file is invalid:<br />json invalid</p>
                        <p>2. Only importing without validating</p>
                        <div class="intro2 clearfix">
                            <p>jsonpyes --data raw_data.json --bulk http://localhost:9200 --import --index myindex2 --type mytype2 <br />Notice: If the raw JSON data file is invalid, jsonpyes will not import it.</p>
                        </div>
                        <p>Or enable multi-threads</p>
                        <div class="intro2 clearfix">
                            <p>jsonpyes --data raw_data.json --bulk http://localhost:9200 --import --index myindex2 --type mytype2 --thread (Number_of_threads) <br />Notice: If the raw JSON data file is invalid, jsonpyes will not import it.</p>
                        </div>
                        <p>3. Both validating and importing</p>
                        <div class="intro2 clearfix">
                            <p>jsonpyes --data raw_data.json --bulk http://localhost:9200 --import --index myindex1 --type mytype1 --check</p>
                        </div>

                        </div>
                        <!-- end row -->

                    </section>
                    <!-- end section -->

                    <section id="line5" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Server strucutre <a href="#top">#back to top</a><hr></h2>
                            </div>
                        </div>
                        <!-- end row -->
                        <div class="row">
                          <img src="./images/Server.png"></img>
                        </div>
                        <div class="row">
                          <p>For more information please visit official HPC site: <a href="http://hpc.lakeheadu.ca/index.php?title=User_Guide">Click here!</a></p>
                        </div>
                    </section>
                    <!-- end section -->

                    <section id="line11" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Copyright and license <a href="#top">#back to top</a><hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">
                            <div class="col-md-12">

                                <p>Code released under the <a href="#" target="_blank">MIT License</a> License.</p>
                                <p>For more information about copyright and license check <a href="https://opensource.org/licenses/MIT" target="_blank">MIT licence</a>.</p>

                            </div>
                        </div>
                        <!-- end row -->

                    </section>
                    <!-- end section -->
                </div>
                <!-- // end .col -->

            </div>
            <!-- // end .row -->

        </div>
        <!-- // end container -->

    </div>
    <!-- end wrapper -->

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/retina.js"></script>
    <script src="js/jquery.fitvids.js"></script>
    <script src="js/wow.js"></script>
    <script src="js/jquery.prettyPhoto.js"></script>

    <!-- CUSTOM PLUGINS -->
    <script src="js/custom.js"></script>
    <script src="js/main.js"></script>

    <script src="js/syntax-highlighter/scripts/shCore.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushXml.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushCss.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushJScript.js"></script>

</body>

</html>
